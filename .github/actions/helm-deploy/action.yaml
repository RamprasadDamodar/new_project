name: helm-deploy
description: "Execute helm package to deploy built image"
inputs:
  image-tag:
    description: "The deploying docker image tag"
    required: true           
          

runs:
  using: composite
  steps:
    - name: replace value file
      id: replace-value-file
      shell: bash
      working-directory: ./deploy/infrastore-chart
      run: |
        pwd
        sed s/%TAG%/${{ inputs.image-tag }}/g values.yaml

    - name: debug value file
      id: debug-value-file
      shell: bash
      working-directory: ./deploy/infrastore-chart
      run: |
        cat values.yaml

    - name: Commit and push changes
      id: commit-push
      shell: bash
      working-directory: ./deploy/infrastore-chart
      run: |
        git config --global user.name "RamprasadDamodar"
        git config --global user.email "Ramprasad.Damodar1989@gmail.com"
        git switch -c test5
        git add .
        git commit -m "Updated image"
        git push origin test5



